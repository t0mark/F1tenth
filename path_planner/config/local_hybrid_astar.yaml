# Hybrid A* Local Planner configuration (Map-based Enhanced)

local_planner:
  ros__parameters:
    node_executable: 'local_hybrid_astar_node'
    node_name: 'local_hybrid_astar_node'

    # Topics
    global_path_topic: '/global_path'
    scan_topic: '/scan'
    odom_topic: '/odom'
    output_topic: '/local_path'
    static_map_topic: '/map'

    # Frames
    map_frame: 'map'
    base_frame: 'base_link'

    # 동적 장애물 필터용 관측 창 크기 (m)
    # 관측 창 너비 (m), 로봇 중심 기준
    grid_width: 7.0
    # 관측 창 높이 (m), 로봇 중심 기준
    grid_height: 7.0
    # 장애물 팽창 반경 (m), 차량 반경 + 그래프 간격 커버
    inflation_radius: 0.25

    # Planner configuration
    # 목표점 거리 (m), 글로벌 경로에서 앞쪽 몇 m 지점을 목표로 삼을지
    lookahead_distance: 5.0
    # 플래너 실행 주기 (Hz), 높을수록 빠른 반응이지만 CPU 부하 증가
    planner_hz: 50.0
    # Hybrid A* 최대 반복 횟수, 많을수록 복잡한 경로 찾지만 느림
    max_iterations: 1500

    # Cost weights (핵심 튜닝 파라미터)
    # 우선순위: 맵 외곽 회피(20) > 동적 장애물(25) > 글로벌 경로 추종(8+3) > 조향 부드러움(3)
    # 조향 변화 페널티, 급격한 핸들 조작 방지 (부드러운 주행)
    steering_change_weight: 3.0
    # 동적 장애물 페널티 (LiDAR), 장애물 강력 회피
    obstacle_cost_weight: 25.0
    # 글로벌 경로 이탈 페널티 (g-cost), 경로 추종 강도
    path_distance_weight: 3.0
    # 목표점 거리 가중치, A* 탐색 방향 결정
    heuristic_weight: 1.0
    # 글로벌 경로 이탈 페널티 (휴리스틱), 경로 주변만 탐색하도록 유도
    global_path_deviation_weight: 8.0
    # 정적 맵 외곽 페널티, 트랙 밖으로 못 나가게 강제 (최우선)
    static_map_penalty_weight: 20.0
    # 동적 장애물 감지 임계값 (그래프 기반), 0~1 범위
    dynamic_obstacle_threshold: 0.7

    # Precomputed local graph visualization
    local_graph_enabled: true
    use_local_graph_planner: true
    local_graph_prefix: 'local_graph'
    local_graph_dir: 'data'
    publish_local_graph_markers: true
    local_graph_marker_topic: '/local_graph_markers'
    local_graph_marker_scale: 0.06
    local_graph_edge_scale: 0.02
